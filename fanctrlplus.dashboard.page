Menu="SystemProfiler:97"
Title="FanCtrl Plus"
---
<?php
$plugin = 'fanctrlplus';
$cfg_dir = "/boot/config/plugins/$plugin";
$statuses = [];

foreach (glob("$cfg_dir/{$plugin}_*.cfg") as $file) {
  $cfg = parse_ini_file($file);
  $custom = $cfg['custom'] ?? basename($file);
  $pid = "/var/run/fanctrlplus_$custom.pid";
  $status = file_exists($pid) ? 'running' : 'stopped';
  $statuses[] = ['name' => $custom, 'status' => $status];
}
?>

<table class='share_status small'>
  <thead>
    <tr><td>Fan</td><td>Status</td></tr>
  </thead>
  <tbody>
    <?php foreach ($statuses as $fan): ?>
    <tr>
      <td><?=htmlspecialchars($fan['name'])?></td>
      <td><?=($fan['status'] == 'running' ? 'ðŸŸ¢' : 'ðŸ”´')?></td>
    </tr>
    <?php endforeach; ?>
  </tbody>
</table>
